---
title: Homepage Governance
category: dev
categoryLabel: Development
description: The homepage now sources hero, benefit, and CTA banner copy from
  `src/content/homepage/landing.mdx`. This guide centralizes editorial
  guardrails so marketing, RevOps, and investor relations can collaborate
  without reverse engineering component implementations.
sourcePath: dev/HOMEPAGE.md
sourceLastModified: 2025-10-04T15:54:28.567Z
tags: []
---

The homepage now sources hero, benefit, and CTA banner copy from
`src/content/homepage/landing.mdx`. This guide centralizes editorial guardrails so
marketing, RevOps, and investor relations can collaborate without reverse engineering
component implementations.

## Hero CTA automation

- `investorCta` in `landing.mdx` now targets
  `/about/white-papers/?whitepaperSlug=apotheon-investor-brief#whitepaper-request` so visitors hit
  the gated request form instead of a static PDF download.
- The query parameter primes `WhitepaperRequestForm` to select the investor brief automatically and
  emits `whitepaper_request_prefill_applied` into `window.dataLayer` for RevOps attribution.
- When adding new investor collateral, replicate this pattern so analytics stay centralized and the
  Worker manifest controls which asset surfaces downstream.

## Hero media pipeline

- `npm run ensure:homepage-hero-media` orchestrates the entire hero asset lifecycle. It first tries
  to run `scripts/design/render-homepage-hero.py`, then falls back to the managed PNG/AVIF/WebP
  embedded in `assets/design/homepage/hero/managed-assets.json` after verifying SHA-256 checksums,
  and only then writes a transparent placeholder.
- The managed assets include `hero-render-context.json` documenting the generator inputs. Update the
  JSON + `managed-assets.json` whenever you change the design and commit both files together so CI
  can gate on integrity drift. Binary media must never be committed directly—use the ledger refresh
  flag below.
- CI jobs call the ensure script before build/test. A checksum mismatch throws and fails the run,
  but the placeholder still lands on disk so downstream tooling (Astro, Ladle, Playwright) has
  deterministic inputs while you debug the issue.
- Local overrides: set `HOMEPAGE_HERO_ASSET_ROOT` / `HOMEPAGE_HERO_MANIFEST_PATH` to experiment in a
  sandbox directory, and `HOMEPAGE_HERO_GOLDEN_ROOT` to validate alternate managed sources (e.g., S3
  buckets) without touching the production ledger. Run `npm run ensure:homepage-hero-media --
--refresh-managed-ledger` once new art is verified to serialize binaries back into
  `managed-assets.json`.
- CI tests disable the renderer with `HOMEPAGE_HERO_DISABLE_RENDER=1` to exercise the managed
  fallback deterministically. Use the same flag during local pipeline drills when Python or Pillow
  is unavailable.

## Welcome tour onboarding

- The first-visit experience hydrates `WelcomeTour` (`src/components/islands/WelcomeTour.tsx`) on the
  homepage with `client:idle` so crawlers still see static markup while new operators receive the
  orientation overlay.
- Copy, labels, and selectors live under `homepage.welcomeTour` in the locale bundles
  (`src/i18n/*/common.json`). Update translations in all locales when editing the copy to keep the
  automation ready for future launches.
- The island persists dismissal in `localStorage` using the
  `apotheon:welcome-tour:v1` key exported from
  `src/components/islands/welcomeTour.constants.ts`. Bumping the version resets the tour for every
  visitor, so only do this when the highlighted flow materially changes.
- Analytics hooks: every lifecycle change dispatches the
  `apotheon:welcome-tour:event` `CustomEvent` and optionally pushes into `window.dataLayer` when a
  `dataLayerEventName` prop is provided. Subscribe once in downstream scripts instead of wiring
  bespoke callbacks per page.
- Regression coverage:
  - Unit tests live in `src/components/islands/__tests__/WelcomeTour.test.tsx`.
  - Playwright flow `tests/e2e/homepage-welcome-tour.spec.ts` verifies keyboard controls and storage
    persistence. Run `npm run test:e2e` (or the full `npm run test`) whenever you touch the tour.
- Highlighted targets use `data-welcome-tour-target` attributes in the header. When adding new steps,
  annotate the relevant markup once and reuse the selectors so the island stays declarative.

## Benefits Grid

- **Schema:** `benefits` is an array of objects (`title`, `proofPoint`, `metric`). The Zod
  schema lives in `src/content/homepage/index.ts` and enforces 3–6 entries.
- **Editorial rules:**
  - Titles should stay under ~35 characters to prevent wrapping on 320 px viewports.
  - Proof points should describe automated, repeatable workflows—avoid language that
    implies manual heroics.
  - Metrics must map to data vetted by RevOps. Update numbers quarterly and document
    the source system inside the PR description for auditability.
- **Automation:**
  - `npm run test` executes `PlatformBenefits.test.tsx`, validating semantic lists and
    aria labeling for the metric emphasis.
  - `npm run ladle:build` exports `homepage/platform-benefits` for async design reviews.
  - When adjusting Tailwind tokens, confirm contrast via the Ladle a11y report and
    rerun `npm run lint` so Stylelint snapshots capture the updates.

## CTA Banners

- **Schema:** `ctaBanners` contains `investor` and `demo` objects with `heading`, `body`,
  optional `secondaryText`, and nested `cta` metadata (`label`, `href`, `ariaLabel`).
- **Contact metadata:** Leave `%officeHours%` in the `secondaryText` template. The Astro
  components replace the token with `footerContact.officeHours`, and the shared
  `formatContactReachability` helper in `src/components/homepage/ctaContactNote.ts`
  injects the email + phone sourced from `src/components/navigation/contactMetadata.ts`
  into the accessible description.
- **Investor flow:** The investor CTA now routes to `/about/investors/` so visitors review
  the diligence context before hitting the contact form. Keep the `ariaLabel` focused on
  navigation semantics ("Navigate to…") instead of form submission language.
- **Accessibility + QA:**
  - Unit tests (`InvestorBanner.test.tsx`, `DemoBanner.test.tsx`) verify aria wiring and
    contact copy. Run `npm run test` whenever banner content changes.
  - Playwright coverage lives in `tests/e2e/homepage-cta-banners.spec.ts`; execute
    `npm run test:e2e` to ensure keyboard activation still navigates correctly.
  - The end-to-end investor journey is captured in `tests/e2e/investor-journey.spec.ts`.
    Run it whenever investor copy or routing changes to verify the contact form preselects
    the Investor relations intent.
  - Ladle stories (`homepage/cta-banners`) provide rapid visual diffing. Rebuild with
    `npm run ladle:build` after color or copy updates so reviewers have fresh artifacts.
- **Background guidance:** Gradients use slate + sky tokens to preserve 4.5:1 contrast.
  When experimenting with new palettes, validate via Tailwind's design tokens,
  rerun `npm run lint` (Stylelint) for token enforcement, and capture screenshots for
  investor compliance review.

## Release Checklist

After editing homepage benefits or CTA banners:

1. Update `landing.mdx` frontmatter with new copy.
2. Run `npm run lint`, `npm run typecheck`, and `npm run test` to exercise schema,
   unit, and accessibility coverage.
3. Execute `npm run test:e2e` to replay keyboard automation for the banners and
   validate the investor journey.
4. Finish with `npm run build` and `npm run ladle:build` so static + documentation
   artifacts stay in sync.
