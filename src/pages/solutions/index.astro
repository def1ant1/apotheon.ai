---
import { getCollection } from 'astro:content';

import MarketingCtaRow from '../../components/marketing/MarketingCtaRow.astro';
import MarketingHero from '../../components/marketing/MarketingHero.astro';
import MarketingShell from '../../components/marketing/MarketingShell.astro';
import { createMarketingIndexTrail } from '../../utils/breadcrumbs';

const solutionEntries = await getCollection('solutions', ({ data }) => !data.draft);
const solutions = solutionEntries
  .map((entry) => ({
    title: entry.data.title,
    summary: entry.data.overview.summary,
    href: `/solutions/${entry.slug}/`,
    featured: entry.data.featured,
    order: entry.data.order ?? 0,
  }))
  .sort((a, b) => (a.order === b.order ? a.title.localeCompare(b.title) : a.order - b.order));

const heroCopy =
  'Select an Apotheon.ai solution to deep dive into architecture, governance, and rollout guidance.';
const breadcrumbs = createMarketingIndexTrail('solutions');
---

<MarketingShell title="Solutions" description={heroCopy} {breadcrumbs}>
  <MarketingHero
    eyebrow="Solutions"
    headline="Launch-ready platform accelerators"
    copy={heroCopy}
    cta={{
      label: 'Talk through your roadmap',
      href: '/about/contact/',
      description: 'Our architects tailor a roadmap once you shortlist modules.',
    }}
  />

  <!--
    The nav grid doubles as a sitemap for search engines and helps Pagefind index short descriptions.
    Future breadcrumb helpers can consume the `breadcrumbs` constant defined above.
  -->
  <section id="solutions-catalog" class="flex flex-col gap-6">
    <h2 class="text-2xl font-semibold text-white">Solution catalog</h2>
    <div class="grid gap-4 md:grid-cols-3">
      {
        solutions.map((solution) => (
          <a
            class={`flex flex-col gap-3 rounded-2xl border border-slate-800 bg-slate-950/40 p-6 transition hover:border-indigo-500 ${
              solution.featured ? 'ring-1 ring-indigo-500/40' : ''
            }`}
            href={solution.href}
          >
            <span class="text-xs uppercase tracking-[0.35rem] text-indigo-300">
              {solution.featured ? 'Featured' : 'Solution'}
            </span>
            <span class="text-lg font-semibold text-white">{solution.title}</span>
            <span class="text-sm text-slate-300">{solution.summary}</span>
          </a>
        ))
      }
    </div>
  </section>

  <MarketingCtaRow
    heading="Where to go next"
    items={[
      {
        title: 'Map solutions to industries',
        description:
          'Review regional compliance, SLAs, and mission fit for your sector before kickoff.',
        href: '/industries/',
        label: 'Visit industry hub',
      },
      {
        title: 'Understand the team',
        description: 'Meet the experts who will stand up, govern, and scale your deployment.',
        href: '/about/team/',
        label: 'Meet leadership',
      },
      {
        title: 'Prepare procurement stakeholders',
        description:
          'Share our operating principles and automation-first workflows to align reviewers.',
        href: '/about/company/',
        label: 'Study company mission',
      },
    ]}
  />
</MarketingShell>
