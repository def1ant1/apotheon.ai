---
import { getCollection, type CollectionEntry } from 'astro:content';

import MarketingCtaRow from '../../components/marketing/MarketingCtaRow.astro';
import MarketingHero from '../../components/marketing/MarketingHero.astro';
import MarketingShell from '../../components/marketing/MarketingShell.astro';
import { createMarketingEntryTrail } from '../../utils/breadcrumbs';

export async function getStaticPaths() {
  const entries = await getCollection('marketing', ({ id }) => id.startsWith('solutions/'));
  return entries.map((entry) => ({
    params: { product: entry.slug.split('/').pop() ?? entry.id },
    props: { entry },
  }));
}

interface Props {
  entry: CollectionEntry<'marketing'>;
}

const { entry } = Astro.props as Props;
const { data } = entry;
const { Content } = await entry.render();
const heroCopy =
  data.summary ??
  'Explore how Apotheon.ai solutions connect data, intelligence, and workflows for global teams.';
const heroCtaLabel = data.heroCtaLabel ?? 'Talk with our architects';
const breadcrumbs = createMarketingEntryTrail(entry);
---

<MarketingShell title={data.title} description={heroCopy} {breadcrumbs}>
  <MarketingHero
    eyebrow="Solutions"
    headline={data.title}
    copy={heroCopy}
    cta={{
      label: heroCtaLabel,
      href: '/about/contact/',
      description: 'Connect with solution engineers for architecture reviews.',
    }}
  />

  <!--
    The article content streams the MDX body from the marketing collection. Keep headings sequential
    (h2 â†’ h3) so future table-of-contents generators can attach without restructuring copy.
  -->
  <article
    class="prose prose-invert prose-headings:font-semibold prose-headings:text-white prose-p:text-slate-200 prose-a:text-indigo-300 max-w-none"
  >
    <Content />
  </article>

  <MarketingCtaRow
    items={[
      {
        title: 'Engage with delivery architects',
        description:
          'Scope migration timelines, integration dependencies, and governance requirements with our services leads.',
        href: '/about/contact/',
        label: 'Plan your migration',
      },
      {
        title: 'Review industry playbooks',
        description:
          'See how Apotheon.ai adapts the platform for healthcare, financial services, and public sector missions.',
        href: '/industries/',
        label: 'Browse industry guides',
      },
      {
        title: 'Explore Nova AI Workbench',
        description:
          'Extend this solution with secure AI experimentation patterns governed by Nova.',
        href: '/solutions/nova/',
        label: 'Visit Nova overview',
      },
    ]}
  />
</MarketingShell>
