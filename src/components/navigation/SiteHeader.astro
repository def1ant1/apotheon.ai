---
const { useTranslations } = await import('astro-i18next');

import { getValidatedNavigationGroups } from './navigationData';
import MobileNavigationDrawer from '../islands/MobileNavigationDrawer';
import RadixNavigationMenu, { type NavigationMenuGroup } from '../islands/RadixNavigationMenu';

/**
 * Consolidated navigation data lives in `navigationData.ts`. Centralizing the lookup allows the
 * header, footer, Ladle stories, and any future surfaces to hydrate from a single validation
 * pipeline while still receiving strongly typed objects.
 */
const { t } = await useTranslations(Astro);
const sanitizedMenuGroups: ReadonlyArray<NavigationMenuGroup> =
  await getValidatedNavigationGroups(t);
---

{
  /**
  The global header anchors the skip link, logo, and navigation landmarks. Explicitly declaring the
  banner role and aria label defends against regressions if we ever wrap the header in additional
  containers or port it into host frameworks that manipulate landmark semantics.
*/
}
<header
  role="banner"
  aria-label={t('navigation.aria.primaryHeader', { defaultValue: 'Primary site header' })}
  class="sticky top-0 z-40 flex justify-center bg-surface-base/70 px-gutter-inline pb-space-sm pt-space-xs backdrop-blur supports-[backdrop-filter]:bg-surface-base/60"
>
  <div class="flex w-full max-w-5xl flex-col gap-space-xs">
    {
      /**
      Keep the skip link as the first interactive element so assistive tech exposes it immediately.
      The target maps to `<main id="main" tabindex="-1">` declared in `BaseLayout`.
    */
    }
    <a class="sr-only focus:not-sr-only" href="#main">
      {t('navigation.skipLink', { defaultValue: 'Skip to content' })}
    </a>

    <div class="flex items-start justify-between gap-space-xs">
      <div class="flex flex-col gap-space-3xs">
        <a
          href="/"
          class="text-title-sm font-black tracking-tight text-ink-primary transition hover:text-accent-brand"
        >
          {t('navigation.brand.name', { defaultValue: 'Apotheon.ai' })}
        </a>
        <p class="text-caption text-ink-muted sm:text-body-sm">
          {
            t('navigation.brand.tagline', {
              defaultValue: 'Automation-first GTM fabric for enterprise AI launches.',
            })
          }
        </p>
      </div>

      <div class="sm:hidden">
        <MobileNavigationDrawer client:idle groups={sanitizedMenuGroups} />
      </div>
    </div>

    <div class="hidden sm:block">
      {
        /** Desktop navigation hydrates lazily; Radix still renders semantic `<nav aria-label="Primary">`. */
      }
      <RadixNavigationMenu client:idle groups={sanitizedMenuGroups} />
    </div>
  </div>
</header>
