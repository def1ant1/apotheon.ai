---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { resolveLocaleFromPath, type PageSeoInput } from '../../utils/seo';
import Breadcrumbs from '../navigation/Breadcrumbs.astro';

import type { BreadcrumbTrail } from '../../utils/breadcrumbs';

interface Props {
  title: string;
  description?: string;
  /**
   * Breadcrumb trail describing the current marketing surface. Defaulting to an empty array keeps
   * hero-only experiences simple while enabling automated trails supplied by the helpers in
   * `src/utils/breadcrumbs`.
   */
  breadcrumbs?: BreadcrumbTrail;
  /**
   * Optional SEO overrides (e.g., custom OpenGraph payloads). Most pages should rely on the base
   * title/description defaults to keep metadata uniform.
   */
  seo?: Partial<PageSeoInput>;
}

const { title, description, breadcrumbs = [], seo: seoOverrides } = Astro.props as Props;

const metaDescription =
  description ??
  'Composable marketing surfaces render statically for global performance while capturing enterprise-ready storytelling.';

const pageSeo: PageSeoInput = {
  ...seoOverrides,
  title: seoOverrides?.title ?? title,
  description: seoOverrides?.description ?? metaDescription,
  path: seoOverrides?.path ?? Astro.url.pathname,
};

const runtimeLocale = pageSeo.locale ?? resolveLocaleFromPath(Astro.url.pathname);
---

{
  /*
  MarketingShell centralizes BaseLayout usage so every marketing page inherits consistent metadata,
  typography, and footer guidance. Authoring teams only pass high-level metadata while this shell
  handles canonical document order (breadcrumbs → hero → content → CTAs).
*/
}
<BaseLayout seo={pageSeo} locale={runtimeLocale}>
  {/** Forward optional head slot content (structured data, meta overrides) to BaseLayout. */}
  <slot name="head" slot="head" />
  {/** Allow pages to inject pre-header affordances such as skip links. */}
  <slot name="preheader" slot="preheader" />
  {
    /**
    Treat the marketing column as a named region so voice navigation tools can reference it by
    title. The accessible name automatically upgrades the `<section>` to a region landmark without
    requiring an explicit `role` attribute.
  */
  }
  <section
    aria-label={`Marketing content: ${title}`}
    class="mx-auto flex w-full max-w-5xl flex-col gap-12 px-6 pb-16"
  >
    {breadcrumbs.length > 0 && <Breadcrumbs class="mt-6" trail={breadcrumbs} />}

    {
      /*
      Content composers inject hero, article content, and CTAs as slot children. Keep slot usage in
      the same order across pages to preserve consistent scanning behavior for humans and crawlers.
    */
    }
    <div class="flex flex-col gap-12">
      <slot />
    </div>
  </section>
</BaseLayout>
